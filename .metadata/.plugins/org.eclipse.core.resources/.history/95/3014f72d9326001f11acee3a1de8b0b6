package test;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class Test2 {

    static String url = "jdbc:mariadb://localhost:3307/tfg";
    static String user = "root";
    static String password = "admin";

    public static void main(String[] args) {
        Object[][] datos = obtenerDatos();
        
        // Imprimir los datos recuperados
        for (Object[] fila : datos) {
            for (Object dato : fila) {
                System.out.print(dato + "\t");
            }
            System.out.println();
        }
    }

    public static Object[][] obtenerDatos() {
        Object[][] datos = null;

        try {
            Connection conn = DriverManager.getConnection(url, user, password);
            String query = "SELECT * FROM dinerinchis";
            PreparedStatement statement = conn.prepareStatement(query);
            ResultSet resultSet = statement.executeQuery();

            // Obtener la cantidad de filas
            resultSet.last();
            int numRows = resultSet.getRow();
            resultSet.beforeFirst();

            // Inicializar la matriz con la cantidad de filas obtenidas
            datos = new Object[numRows][5]; // Ahora la matriz tiene 5 columnas

            // Recorrer los resultados y almacenar en la matriz
            int fila = 0;
            while (resultSet.next()) {
                String nombre = resultSet.getString("Nombre");
                double edad = resultSet.getDouble("Edad");
                double salario = resultSet.getDouble("Salario");
                String genero = resultSet.getString("Genero");
                String departamento = resultSet.getString("Departamento");

                // Almacenar los datos en la matriz
                datos[fila][0] = nombre; // Nombre
                datos[fila][1] = edad; // Edad
                datos[fila][2] = salario; // Salario
                datos[fila][3] = genero; // GÃ©nero
                datos[fila][4] = departamento; // Departamento

                fila++;
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }

        return datos;
    }
}

